# Copyright Tomer Figenblat.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""Switcher integration TCP socket API packet formats."""

# weekdays sum, start-time timestamp, end-time timestamp
SCHEDULE_CREATE_DATA_FORMAT = "01{}01{}{}"

NO_TIMER_REQUESTED = "00000000"
NON_RECURRING_SCHEDULE = "00"
# format values are local session id, timestamp
REQUEST_FORMAT_TYPE1 = "{}340001000000000000000000{}00000000000000000000f0fe"
REQUEST_FORMAT2_TYPE2 = "{}390001000000000000000000{}00000000000000000000f0fe"

REQUEST_FORMAT_BREEZE = "{}000001000000000000000000{}00000000000000000000f0fe"
PAD_72_ZEROS = "0" * 72
# format value just timestamp (initial session id is "00000000")
LOGIN_PACKET_TYPE1 = (
    "fef052000232a10000000000" + REQUEST_FORMAT_TYPE1[2:] + "{}" + PAD_72_ZEROS + "00"
)

LOGIN2_PACKET_TYPE2 = (
    "fef030000305a60000000000ff0301000000000000000000{}00000000000000000000f0fe{}00"
)

# format values are local session id, timestamp, device id
GET_STATE_PACKET_TYPE1 = "fef0300002320103" + REQUEST_FORMAT_TYPE1 + "{}00"

# format values are local session id, timestamp, device id
GET_STATE_PACKET2_TYPE2 = "fef0300003050103" + REQUEST_FORMAT2_TYPE2 + "{}00"

# format values are local session id, timestamp, device id, command, timer
SEND_CONTROL_PACKET = (
    "fef05d0002320102" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "000106000{}00{}"
)
# format values are local session id, timestamp, device id, auto-off seconds
SET_AUTO_OFF_SET_PACKET = (
    "fef05b0002320102" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "00040400{}"
)
# format values are local session id, timestamp, device id, name
UPDATE_DEVICE_NAME_PACKET = (
    "fef0740002320202" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "00{}"
)
# format values are local session id, timestamp, device id
GET_SCHEDULES_PACKET = (
    "fef0570002320102" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "00060000"
)
# format values are local session id, timestamp, device id, schedule id
DELETE_SCHEDULE_PACKET = (
    "fef0580002320102" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "000801000{}"
)
# format values are local session id, timestamp, device id,
# schedule data =
#                   (on_off + week + timestamp + start_time + end_time)
CREATE_SCHEDULE_PACKET = (
    "fef0630002320102" + REQUEST_FORMAT_TYPE1 + "{}" + PAD_72_ZEROS + "00030c00ff{}"
)
# format values are local session id, timestamp, device id, phone id, device-
# password, command length, command
BREEZE_COMMAND_PACKET_X = (
    "fef0" + "00000" + "3050102" + "{}000001000000000000000000{}00000000000000000000f0fe" + "{}" + PAD_72_ZEROS + "3701" + "{}{}"
)

# format values are local session id, 0000?, device_id, timestamp, device_id, command.length, command, timestamp
BREEZE_COMMAND_PACKET = (
    # works:
    # "fef0" + "0a010" + "3050102" + "{}0000" + "01000000" + "{}" + "000000" + "{}" + "00000000000000000000" + "f0fe" + "{}" + "008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a" + "3701" + "{}{}"
     "fef0" + "0a010" + "3050102" + "{}0000" + "01000000" + "{}" + "000000" + "{}" + "00000000000000000000" + "f0fe" + "{}" + "008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a" + "3701" + "{}{}"
    # "fef00" + "3050102" + "{}0000" + "01000000" + "{}" + "000000" + "{}" + "00000000000000000000" + "f0fe" + "{}" + "008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a" + "3701" + "{}{}"
)

# login response: fef04c000400a600 00000000 ff03 02000000000000000000 cba79f6600000000000000000000 f0fe 0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2995eb20
# login response: fef04c000400a600 00000000 ff03 02000000000000000000 98ac9f6600000000000000000000 f0fe 12131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f3031995d8de5
# REQUEST_FORMAT_BREEZE = "{}000001000000000000000000{}00000000000000000000 f0fe"
# from code control:
# fef00 0000 3050102 00000000 000001000000000000000000 20a89e66 00000000000000000000 f0fe 7e61b7 000000000000000000000000000000000000000000000000000000000000000000000000     3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 93631303036 304135 30303036303031443243323030433143383030303033303143303030303030313530303030303030323830
# from ws but sent from code:
# fef010e00 3050102000000000000010000007e61b700000082ad9f6600000000000000000000f0fe7e61b7008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701b300000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3938363030363041343030303630303135333043303043314338303030303230313430303030303031353030303030303032383000000000d3109546

# from code again:
# fef00 a010 3050102 00000000 0000 01000000 7e61b7 000000 c0aa9f66 00000000000000000000 f0fe 7e61b7 008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 93836303036 304134 30303036303031353330433030433143383030303032303134303030303030313530303030303030323830 c0aa9f66
# from wireshark turn off:
# fef00 a010 3050102 00000000 8602 01000000 7e61b7 000000 b1409f66 00000000000000000000 f0fe 7e61b7 008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 84339303034 304134 30303036303030313139323030383143383030303032383234303030303030313530303030303030323830 0b9933a7
# from wireshark turn on:
# fef00 a010 3050102 00000000 cd02 01000000 7e61b7 000000 2a419f66 00000000000000000000 f0fe 7e61b7 008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 93839303036 304134 30303036303030333331323030433143383030303032303243303030303030313530303030303030323830 f01604d8
# from wireshark 24 degree:
# fef00 a010 3050102 00000000 0603 01000000 7e61b7 000000 78419f66 00000000000000000000 f0fe 7e61b7 008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 93831303036 304134 30303036303031443330323030433143383030303032303043303030303030313530303030303030323830 39180d31
# from wireshark 23 degree:
# fef00 a010 3050102 00000000 5503 01000000 7e61b7 000000 e5419f66 00000000000000000000 f0fe 7e61b7 008828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701 b300 000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c3 93845303036 304134 30303036303030443331433030433143383030303032303334303030303030313530303030303030323830 fd50f1ca


# from code, status:
# fef00 0000 305010e 00000000000001000000000000000000bfaf9e6600000000000000000000f0fe7e61b7000000000000000000000000000000000000000000000000000000000000000000000000370100030b040001041610
# from wireshark 1: session + ? + 4010000 + device id + 000005 + ? + 00000000000000000000 + f0fe + 00 +
# fef00 a010 3050102 00000000 170 401000000 7e61b7 0000005 d619d66 00000000000000000000 f0fe 7e61b7 00 8828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701b300000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c39434530303630413430303036303030443339433030433143383030303032383343303030303030313530303030303030323830 364d1ed1
# from wireshark 2:
# fef00 a010 3050102 00000000 150 401000000 7e61b7 0000005 c619d66 00000000000000000000 f0fe 7e61b7 00 8828e9111cb3f472f33bf96af2fcc8f9f07f7b11a436cff65fd6a8c9082a6c1049201a 3701b300000000004e4543587c32367c33327c31352c31357c31352c34307c31357c537c43397c30317c30303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d313530303035463030303031353641425b32335d31353030303246385b32305d7c39433130303630413430303036303031443338323030433143383030303032383030303030303030313530303030303030323830 af3b969e
# from wireshark 3:
# fef03 0000 3050103 00000000 130 401000000 7e61b7 0000005 a619d66 00000000000000000000 f0fe 7e61b7 00 4267ebb5



# format values are local session id, timestamp, device id, phone id, device-
# password, state, mode, target temp, fan level, swing
BREEZE_UPDATE_STATUS_PACKET = (
    "fef000000305010e"
    + REQUEST_FORMAT_BREEZE
    + "{}"
    + PAD_72_ZEROS
    + "370100030b0400"
    + "{}{}{:02x}{}{}"
)

# format values are local session id, timestamp, device id
RUNNER_STOP_COMMAND = (
    "fef0590003050102"
    + "{}"
    + "232301"
    + "000000000000000000"
    + "{}"
    + "00000000000000000000f0fe"
    + "{}"
    + PAD_72_ZEROS
    + "370202000000"
)

RUNNER_SET_POSITION = (
    "fef0580003050102{}290401"
    + "000000000000000000"
    + "{}"
    + "00000000000000000000f0fe"
    + "{}"
    + PAD_72_ZEROS
    + "3701"
    + "0100"
    + "{}"
)


